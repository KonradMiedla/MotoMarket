<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, shrink-to-fit=no" />
    <title>MotoMarket</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.2.0/css/datepicker.min.css"
        rel="stylesheet">
    <script async src="https://www.google.com/recaptcha/api.js"></script>


</head>

<body>

    <nav class="navbar navbar-expand-lg navbar-light">
        <div class="container-fluid">
          <a class="navbar-brand" href="index.html">
            <img src="MotoMarket.png">
          </a>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarContent"
            aria-controls="navbarContent" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
          </button>
          <div class="collapse navbar-collapse" id="navbarContent">
            <ul class="navbar-nav me-auto">
              <li class="nav-item">
                <a class="nav-link" id="addAd" href="addAd.html"><h5 class="fw-bold">Dodaj ogłoszenie</h5></a>
              </li>
            </ul>
            <ul class="navbar-nav ms-auto">
              <li class="nav-item">
                <a class="nav-link" id="log&register" href="log&register.html"><h5 class="fw-bold">Logowanie | Rejestracja</h5></a>
              </li>
              <li class="nav-item">
                  <a id="nick" class="nav-link" href="userSettings.html"></a>
                  <a id="logout" class="nav-link" href="#"></a>
              </li>
            </ul>
          </div>
        </div>
      </nav>

      <div class="container mb-5 mt-5">
        <div class="row">
            <div class="col-12 col-xl-8">
                 <img class="img-fluid" id="displayImage">
            </div>
            <div class="col-12 col-xl-4">
                <h4><strong id="viewBrand"></strong> <strong id="viewModel"></strong></h4>
                <h6 id="viewTitle"></h6>
                <!--<h6 id="viewYMeCfT"></h6>-->
                <h4 class="text-danger" id="viewPrice"></h4>
                <div class="mt-5">
                    <h5>Informacje o sprzedającym:</h5>
                    <h6 id="viewPersonName"></h6>
                    <h6 id="viewCity"></h6>
                    <div class="form-group text-center" id="recaptchaHideTel">
                        <small>Wyświetl numer telefonu</small>
                        <div class="g-recaptcha" data-sitekey="6LfPT-IeAAAAAPs85ZbjM2HJKsdLaqCNdC4sASQn"
                        data-callback="recaptcha_callback_tel"></div>
                    </div>
                    <h6 id="viewTelephone" hidden></h6>
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col-12 col-lg-9 col-xl-8 mt-5">
                <h4 class="mb-2">Informacje</h4>
                <div class="row">
                    <div class="col-6 col-md-3">
                        <h6>Marka pojazdu:</h6>
                        <h6>Model pojazdu:</h6>
                        <h6>Rok produkcji:</h6>
                        <h6>Rodzaj paliwa:</h6>
                        <h6>Skrzynia biegów:</h6>
                        <h6>Napęd:</h6>
                    </div>
                    <div class="col-6 col-md-3">
                        <h6 id="viewBrand1"></h6>
                        <h6 id="viewModel1"></h6>
                        <h6 id="viewYear1"></h6>
                        <h6 id="viewFuelType1"></h6>
                        <h6 id="viewGear1"></h6>
                        <h6 id="viewwWheelDrive1"></h6>
                    </div>
                    <div class="col-6 col-md-3">
                        <h6>Przebieg</h6>
                        <h6>Pojemnośc skokowa:</h6>
                        <h6>Moc:</h6>     
                        <h6>Numer rejestracyjny:</h6>
                        <h6>Numer VIN:</h6>
                        <div class="form-group text-center" id="recaptchaHideVIN">
                            <small>Wyświetl numer VIN</small>
                            <div class="g-recaptcha" data-sitekey="6LfPT-IeAAAAAPs85ZbjM2HJKsdLaqCNdC4sASQn"
                            data-callback="recaptcha_callback_vin"></div>
                        </div>
                    </div>
                    <div class="col-6 col-md-3">
                        <h6 id="viewMileage1"></h6>
                        <h6 id="viewEngineCapacity1"></h6>   
                        <h6 id="viewPower1"></h6>
                        <h6 id="viewPlates1"></h6>
                        <h6 id="viewVIN1" hidden></h6>
                    </div>
                </div>
                <div class="col-12 mt-5">
                    <h5>Opis pojazdu</h5>
                    <h6 id="viewDescription"></h6>
                </div>
            </div>
        </div>
    </div>

    <footer class="text-center text-lg-start text-muted">
        <section class="d-flex justify-content-center p-4 bg-light">
            <div class="container text-center text-md-start mt-5">
                <div class="row mt-3">
                    <div class="col-md-3 col-lg-4 col-xl-3 mx-auto mb-4">
                        <h6 class="text-uppercase fw-bold mb-4">
                            MotoMarket
                        </h6>
                        <p>
                          MotoMarket to witryna z darmowymi ogłoszeniami samochodów, 
                          dzięki której łatwiej pozyskasz potencjalnych kupców jak i znajdziesz swój wymarzony pojazd.
                        </p>
                    </div>
    
                    <div class="col-md-2 col-lg-2 col-xl-2 mx-auto mb-4">
                        <h6 class="text-uppercase fw-bold mb-4">
                            Prywatność
                        </h6>
                        <p>
                            <a href="statute.html" class="me-4 text-reset">Regulamin MotoMarket</a>
                        </p>
                        <p>
                            <a href="privacyPolicy.html" class="me-4 text-reset">Polityka prywatności</a>
                        </p>
                    </div>
    
                    <div class="col-md-3 col-lg-2 col-xl-2 mx-auto mb-4">
    
                        <h6 class="text-uppercase fw-bold mb-4">
                            Przydatne linki
                        </h6>
                        <p>
                            <a href="userSettings.html" class="text-reset" id="use-links-myAcc">Moje konto</a>
                        </p>
                        <p>
                            <a href="addAd.html" class="text-reset" id="use-links-addAd">Dodaj ogłoszenie</a>
                        </p>
                        <p>
                          <a href="log&register.html" class="text-reset" id="use-links-createAcc">Załóż konto</a>
                        </p>
                    </div>
    
                    <div class="col-md-4 col-lg-3 col-xl-3 mx-auto mb-md-0 mb-4">
                        <h6 class="text-uppercase fw-bold mb-4">
                            Kontakt
                        </h6>
                        <p>
                            <i class="fas fa-envelope me-3"></i>
                            info@motomarket.com
                        </p>
                        <p>
                            <i class="fas fa-phone me-3"></i>
                            +48 123 456 789
                        </p>
                    </div>
                </div>
            </div>
        </section>
    
        <section class="d-flex justify-content-center justify-content-lg-between p-4 border-top" id="copy">
            <div class="me-5">
                © Copyright 2022 by MotoMarket. Wszystkie prawa zastrzeżone.
            </div>
            <div>
                <a href="" class="me-4 text-reset" target="_blank">
                    <i class="fab fa-facebook-square fa-lg"></i>
                </a>
                <a href="" class="me-4 text-reset" target="blank">
                    <i class="fab fa-twitter fa-lg"></i>
                </a>
                <a href="" class="me-4 text-reset" target="_blank">
                    <i class="fab fa-instagram fa-lg"></i>
                </a>
            </div>
        </section>
    </footer>

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous">
    </script>
    <script type="module">
        // Import the functions you need from the SDKs you need
        import { initializeApp } from "https://www.gstatic.com/firebasejs/9.6.7/firebase-app.js";
        import { getAnalytics } from "https://www.gstatic.com/firebasejs/9.6.7/firebase-analytics.js";
        import { getDatabase, set, ref, update, onValue, get, child } from "https://www.gstatic.com/firebasejs/9.6.7/firebase-database.js";
        import {
            getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword,
            onAuthStateChanged, signOut
        }
            from "https://www.gstatic.com/firebasejs/9.6.7/firebase-auth.js";


        // TODO: Add SDKs for Firebase products that you want to use
        // https://firebase.google.com/docs/web/setup#available-libraries

        // Your web app's Firebase configuration
        // For Firebase JS SDK v7.20.0 and later, measurementId is optional
        const firebaseConfig = {
            apiKey: "AIzaSyBlMR02T_Em1KhTTpX8RnnipDUqOau9grA",
            authDomain: "motomarket-37668.firebaseapp.com",
            databaseURL: "https://motomarket-37668-default-rtdb.europe-west1.firebasedatabase.app",
            projectId: "motomarket-37668",
            storageBucket: "motomarket-37668.appspot.com",
            messagingSenderId: "715586433513",
            appId: "1:715586433513:web:34520927576e02111c5b78",
            measurementId: "G-3FH4J49EM0"
        };

        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const analytics = getAnalytics(app);
        const database = getDatabase(app);
        const auth = getAuth();
        const user = auth.currentUser;

        onAuthStateChanged(auth, (user) => {
            if (user) {
                const user = auth.currentUser;
                const displayName = user.displayName
                const uid = user.uid;

                document.getElementById("nick").innerHTML = "<h5 class='fw-bold'><i class='fas fa-user'></i> "
                + displayName + "</h5>";
                document.getElementById("logout").innerHTML = "<h5 class='fw-bold'>Wyloguj<h5>";
                document.getElementById("log&register").style.display = "none";
                document.getElementById("use-links-createAcc").style.display = "none";
            }
            else {
                document.getElementById("addAd").style.display = "none";
                document.getElementById("use-links-myAcc").style.display = "none";
                document.getElementById("use-links-addAd").style.display = "none";
            }
        });

        logout.addEventListener('click', (e) => {
            signOut(auth).then(() => {
                alert("Wylogowano!");
                window.location.href = "index.html";
            }).catch((error) => {
                const errorCode = error.code;
                const errorMessage = error.message;

                console.log(errorCode + ": " + errorMessage);
            });
        });

        var mar = localStorage.getItem("mar");

        const starCountRef = ref(database, 'ads/' + mar);
        onValue(starCountRef, (snapshot) => {
            const data = snapshot.val();

            document.getElementById("viewBrand").innerHTML = data.brand;
            document.getElementById("viewBrand1").innerHTML = data.brand;
            document.getElementById("viewModel").innerHTML = data.model;
            document.getElementById("viewModel1").innerHTML = data.model;
            document.getElementById("viewYear1").innerHTML = data.year;
            document.getElementById("viewFuelType1").innerHTML = data.fuelType;
            document.getElementById("viewMileage1").innerHTML = data.mileage.toLocaleString() + " km";
            document.getElementById("viewEngineCapacity1").innerHTML = data.engineCapacity + ` cm<sup>3</sup>`
            document.getElementById("viewVIN1").innerHTML = data.VIN;
            document.getElementById("viewCity").innerHTML = '<i class="fas fa-map-marker-alt"></i> ' + data.city
            document.getElementById("viewDescription").innerHTML = data.description;
            document.getElementById("viewGear1").innerHTML = data.gear;
            document.getElementById("viewPersonName").innerHTML = data.personName;
            document.getElementById("viewPlates1").innerHTML = data.plates;
            document.getElementById("viewPower1").innerHTML = data.power + " KM";
            document.getElementById("viewPrice").innerHTML = data.price.toLocaleString() + " PLN";
            document.getElementById("viewTelephone").innerHTML = "Numer telefonu: " + data.telephone.toLocaleString();
            document.getElementById("viewTitle").innerHTML = data.title;
            document.getElementById("viewwWheelDrive1").innerHTML = data.wheelDrive;
            document.getElementById('displayImage').setAttribute('src', data.url);
        });

    </script>
    <script>
        function recaptcha_callback_tel()
        {
            var showTelephone = document.getElementById('viewTelephone');
            var recaptchaHide = document.getElementById('recaptchaHideTel');
            showTelephone.removeAttribute('hidden');
            recaptchaHideTel.setAttribute('hidden', 'true');
        }
        function recaptcha_callback_vin()
        {
            var showVIN = document.getElementById('viewVIN1');
            var recaptchaHide = document.getElementById('recaptchaHideVIN');
            showVIN.removeAttribute('hidden');
            recaptchaHideVIN.setAttribute('hidden', 'true');
        }
    </script>
</body>

</html>